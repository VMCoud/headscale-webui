{% extends 'template.html' %}
{% set page = "Settings" %}
{% set settings_active = "active" %}
{% block title  %} {{ page }} {% endblock %}
{% block header %} {{ page }} {% endblock %}
{% block OIDC_NAV_DROPDOWN %} {{ OIDC_NAV_DROPDOWN}} {% endblock %}
{% block OIDC_NAV_MOBILE %}   {{ OIDC_NAV_MOBILE  }} {% endblock %}

{% block content %}
<div class="row"><br>
    <div class="col s0 m0 l0 xl3"></div>
    <div class="col s12 m12 l12 xl6">
      <div class="card hoverable">
        <div class="card-content">
          <span class="card-title">服务器信息</span>
          <div class="input-field">
            <i class="material-icons prefix">vpn_key</i>
            <input id="api_key" type="password">
            <label for="api_key">API 密钥</label>
          </div>
        </div>
        <div class="card-action">
          <a href="#test_modal"         class="modal-trigger" onclick="save_key()">保存</a>
          <a href="#test_modal"         class="modal-trigger" onclick='test_key()'>测试</a>
          <a href="#instructions_modal" class="modal-trigger">说明</a>
        </div>
      </div>
    </div>
    <div class="col s0 m0 l0 xl3"></div>
  </div>
  <div class="row">
    <div class="col s0 m0 l0 xl3"></div>
    <div class="col s12 m12 l12 xl6">
      <div class="card hoverable">
        <div class="card-content">
          <span class="card-title">关于</span>
          <table class="striped">
            <tbody>
              <tr><td>兼容性</td><td><a href="https://github.com/juanfont/headscale">Headscale {{ HS_VERSION }}</a></td></tr>
              <tr><td>应用版本</td><td>{{ APP_VERSION }}</td></tr>
              <tr><td>构建日期</td><td> {{ BUILD_DATE }}</td></tr>
              <tr><td>Git 提交</td><td>{{ GIT_COMMIT }}</td></tr>
              <tr><td>Git 分支</td><td>{{ GIT_BRANCH }}</td></tr>
              <tr><td>源代码</td><td><a href="https://github.com/iFargle/headscale-webui">Github</a></td></tr>
              <tr><td>汉化支持</td><td>闲鱼APP:帅帅的南山</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col s0 m0 l0 xl3"></div>
  </div>
<!-- 模态框 -->
    <div id="instructions_modal" class="modal">
        <div class="modal-content">
            <h4>说明</h4>
            <ul class="browser-default">
                <li>要生成 API 密钥，请在控制服务器上运行命令 <a class="{{ COLOR_BTN }} white-text">headscale apikeys create</a>。一旦生成第一个密钥，此用户界面将在密钥接近过期时自动续订密钥。</li>
                <li>Headscale 服务器通过 Docker 中的 <a class="{{ COLOR_BTN }} white-text">HS_SERVER</a> 环境变量进行配置。当前服务器：<a class="{{ COLOR_BTN }} white-text"> {{url}} </a></li>
                <li>您必须通过 Docker 中的 <a class="{{ COLOR_BTN }} white-text">KEY</a> 环境变量配置加密密钥。可以使用命令 <a class="{{ COLOR_BTN }} white-text">openssl rand -base64 32</a> 生成密钥。</li>
                <li>输入由 headscale 生成的 API 密钥，点击 "保存"，然后点击 "测试"。在使用 "测试" 按钮之前保存是重要的。</li>
            </ul>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close btn-flat">关闭</a>
        </div>
    </div>
    <div id="test_modal" class="modal">
        <div class="modal-content">
            <h4>Headscale API 密钥测试</h4>
            <span id="test_modal_results"></span>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close btn-flat">关闭</a>
        </div>
    </div>
    <div id="theme_modal" class="modal">
        <div class="modal-content">
            <h4>Web UI 主题设置</h4>
            <span id="theme_modal_body"></span>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close btn-flat">关闭</a>
        </div>
    </div>
{% endblock %}

